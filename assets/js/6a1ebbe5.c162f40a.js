"use strict";(self.webpackChunktracetest_docs=self.webpackChunktracetest_docs||[]).push([[318],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),i=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=i(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=i(n),m=a,g=d["".concat(c,".").concat(m)]||d[m]||u[m]||o;return n?r.createElement(g,l(l({ref:t},p),{},{components:n})):r.createElement(g,l({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var i=2;i<o;i++)l[i]=n[i];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6303:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>i});var r=n(7462),a=(n(7294),n(3905));const o={},l="Run Tracetest Locally",s={unversionedId:"run-locally",id:"run-locally",title:"Run Tracetest Locally",description:"Tracetest depends on a postgres database and a trace store backend (Jaeger or Tempo). The frontend requires node and npm and the backend requires the go tooling.",source:"@site/docs/run-locally.md",sourceDirName:".",slug:"/run-locally",permalink:"/run-locally",draft:!1,editUrl:"https://github.com/kubeshop/tracetest/blob/main/docs/docs/run-locally.md",tags:[],version:"current",frontMatter:{}},c={},i=[{value:"<strong>Run on Local Kubernetes</strong>",id:"run-on-local-kubernetes",level:2},{value:"<strong>Installing Jaeger</strong>",id:"installing-jaeger",level:3},{value:"<strong>Install Tracetest</strong>",id:"install-tracetest",level:3},{value:"<strong>Run a Development Build</strong>",id:"run-a-development-build",level:2},{value:"<strong>Start Development Server</strong>",id:"start-development-server",level:3}],p={toc:i};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"run-tracetest-locally"},"Run Tracetest Locally"),(0,a.kt)("p",null,"Tracetest depends on a postgres database and a trace store backend (Jaeger or Tempo). The frontend requires node and npm and the backend requires the go tooling."),(0,a.kt)("h2",{id:"run-on-local-kubernetes"},(0,a.kt)("strong",{parentName:"h2"},"Run on Local Kubernetes")),(0,a.kt)("p",null,"Tracetest and its dependencies can be installed in a local Kubernetes cluster (microk8s, minikube, Kubernetes for Docker Desktop, etc).\nFollowing the ",(0,a.kt)("a",{parentName:"p",href:"./getting-started/installation"},"install steps")," will install a running instance of Tracetest and Postgres. Installing Jaeger is the easiest way to get a trace store backend."),(0,a.kt)("p",null,"The Tracetest install can be exposed with a ",(0,a.kt)("inlineCode",{parentName:"p"},"LoadBalancer"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"NodePort")," or any similar mechanism. It can also be kept internally, only expose the Jaeger and postgres port,\nand use them to run local development builds. This is useful to quickly test changes on both the front and back end."),(0,a.kt)("h3",{id:"installing-jaeger"},(0,a.kt)("strong",{parentName:"h3"},"Installing Jaeger")),(0,a.kt)("p",null,"Before installing Tracetest, we need to setup the ",(0,a.kt)("a",{parentName:"p",href:"https://www.jaegertracing.io/docs/1.32/operator/"},"Jaeger operator"),", which in turn has a dependency on ",(0,a.kt)("a",{parentName:"p",href:"https://cert-manager.io/"},"cert-mnanager"),".\ncert-manager has different ",(0,a.kt)("a",{parentName:"p",href:"https://cert-manager.io/docs/installation/"},"install options"),". The simplest way to do this is to use a static install:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.8.0/cert-manager.yaml\n")),(0,a.kt)("p",null,"Once the pods in ",(0,a.kt)("inlineCode",{parentName:"p"},"cert-manager")," namespace are running, we can install the Jaeger operator:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl create namespace observability\nkubectl create -f https://github.com/jaegertracing/jaeger-operator/releases/download/v1.32.0/jaeger-operator.yaml -n observability\n")),(0,a.kt)("p",null,"Now, create an ",(0,a.kt)("inlineCode",{parentName:"p"},"AllInOne")," jaeger instance:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cat <<EOF | kubectl create -f -\napiVersion: jaegertracing.io/v1\nkind: Jaeger\nmetadata:\n  name: jaeger\nEOF\n")),(0,a.kt)("h3",{id:"install-tracetest"},(0,a.kt)("strong",{parentName:"h3"},"Install Tracetest")),(0,a.kt)("p",null,"Follow the ",(0,a.kt)("a",{parentName:"p",href:"./getting-started/installation"},"install steps"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'helm repo add kubeshop https://kubeshop.github.io/helm-charts\nhelm repo update\n\nhelm install tracetest kubeshop/tracetest \\\n  --set telemetry.dataStores.jaeger.jaeger.endpoint="jaeger-query:16685" \\ # update this value to point to your jaeger install\n  --set telemetry.exporters.collector.exporter.collector.endpoint="otel-collector:4317" \\ # update this value to point to your collector install\n  --set server.telemetry.dataStore="jaeger"\n')),(0,a.kt)("p",null,"You can now expose the Tracetest service using a ",(0,a.kt)("inlineCode",{parentName:"p"},"LoadBalancer"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"NodePort")," or even a simple ",(0,a.kt)("inlineCode",{parentName:"p"},"port-forward"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl port-forward svc/tracetest 11633:11633\n")),(0,a.kt)("p",null,"Now Tracetest is available at ","[http://localhost:11633]"),(0,a.kt)("h2",{id:"run-a-development-build"},(0,a.kt)("strong",{parentName:"h2"},"Run a Development Build")),(0,a.kt)("p",null,"Now that Tracetest is running, we can expose the dependencies in our cluster to the host machine so they are accessible to the development build.\nTracetests needs postgres to store the tests, results, etc, and access to the trace backend (jaeger, tempo, etc) to fetch traces.\nWe can use kubectl's port forwarding capabilites for this"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'(trap "kill 0" SIGINT; kubectl port-forward svc/tracetest-postgresql 5432:5432 & kubectl port-forward svc/jaeger-query 16685:16685)\n')),(0,a.kt)("h3",{id:"start-development-server"},(0,a.kt)("strong",{parentName:"h3"},"Start Development Server")),(0,a.kt)("p",null,"When running the development version, the frontend and backend are built and run separately. You need to have both services running to access the tool."),(0,a.kt)("p",null,"To start the backend server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"make server-run\n")),(0,a.kt)("p",null,"To start the frontend server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd web\nnpm install -d\nnpm start\n")),(0,a.kt)("p",null,"The Tracetest development build is available at ","[http://localhost:3000]",". Note that the port is now ",(0,a.kt)("inlineCode",{parentName:"p"},"3000")," since we are accessing the node development server."))}u.isMDXComponent=!0}}]);